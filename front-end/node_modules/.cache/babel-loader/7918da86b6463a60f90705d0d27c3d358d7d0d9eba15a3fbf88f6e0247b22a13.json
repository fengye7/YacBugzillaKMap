{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-6a1c0054\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"KMapChart\",\n  class: \"k-map-chart\"\n}, null, -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_container = _resolveComponent(\"el-container\");\n  return _openBlock(), _createBlock(_component_el_container, null, {\n    default: _withCtx(() => [_hoisted_1, _createElementVNode(\"div\", null, [_createVNode(_component_el_input, {\n      modelValue: $setup.competitorDomains,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.competitorDomains = $event),\n      placeholder: \"输入竞争公司域名, 以逗号分隔\",\n      style: {\n        \"margin-bottom\": \"20px\"\n      }\n    }, null, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_button, {\n      onClick: $setup.fetchData\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"获取数据\")]),\n      _: 1 /* STABLE */\n    })]), _createElementVNode(\"div\", null, [_createVNode($setup[\"ElLoading\"], {\n      loading: $setup.loading,\n      text: \"数据加载中...\",\n      fullscreen: \"\"\n    }, null, 8 /* PROPS */, [\"loading\"])])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createElementVNode","id","class","_createBlock","_component_el_container","default","_withCtx","_hoisted_1","_createVNode","_component_el_input","modelValue","$setup","competitorDomains","_cache","$event","placeholder","style","_component_el_button","onClick","fetchData","_createTextVNode","_","loading","text","fullscreen"],"sources":["D:\\Files\\Code\\CoursesProjects\\YacBugzilla_KnowledgeMap\\front-end\\src\\components\\KMapCharts.vue"],"sourcesContent":["<template>\r\n  <el-container>\r\n    <div id=\"KMapChart\" class=\"k-map-chart\"></div>\r\n    <div>\r\n      <el-input\r\n        v-model=\"competitorDomains\"\r\n        placeholder=\"输入竞争公司域名, 以逗号分隔\"\r\n        style=\"margin-bottom: 20px\"\r\n      ></el-input>\r\n      <el-button @click=\"fetchData\">获取数据</el-button>\r\n    </div>\r\n    <div>\r\n      <el-loading\r\n        :loading=\"loading\"\r\n        text=\"数据加载中...\"\r\n        fullscreen\r\n      ></el-loading>\r\n    </div>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref } from \"vue\";\r\nimport { getKMapData } from \"@/api/KMapAPI.js\";\r\nimport * as echarts from \"echarts\";\r\nimport { ElLoading } from \"element-plus\";\r\n\r\nconst seriesData = ref([]);\r\nconst seriesLinks = ref([]);\r\nconst categories = ref([\r\n  { name: \"product\" },\r\n  { name: \"component\" },\r\n  { name: \"assignee\" },\r\n]);\r\n\r\nconst competitorDomains = ref(\"\");\r\nconst loading = ref(false);\r\n\r\nonMounted(() => {\r\n  initKMapChart();\r\n});\r\n\r\nasync function fetchData() {\r\n  loading.value = true;\r\n  try {\r\n    const domains = competitorDomains.value\r\n      .split(\",\")\r\n      .map((domain) => domain.trim());\r\n    const response = await getKMapData(domains);\r\n    const kMapData = response.data;\r\n    formatData(kMapData);\r\n    initKMapChart();\r\n  } catch (error) {\r\n    console.error(\"Error fetching data:\", error);\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nfunction formatData(data) {\r\n  seriesData.value = data.nodes;\r\n  seriesLinks.value = data.links;\r\n}\r\n\r\nfunction initKMapChart() {\r\n  const chartDom = document.getElementById(\"KMapChart\");\r\n  const myChart = echarts.init(chartDom);\r\n  const option = {\r\n    animationDurationUpdate: 500,\r\n    animationEasingUpdate: \"quinticInOut\",\r\n    tooltip: {\r\n      show: true,\r\n    },\r\n    series: [\r\n      {\r\n        type: \"graph\",\r\n        layout: \"force\",\r\n        data: seriesData.value,\r\n        links: seriesLinks.value,\r\n        categories: categories.value,\r\n        roam: true,\r\n        label: {\r\n          position: \"right\",\r\n          formatter: \"{b}\",\r\n        },\r\n        lineStyle: {\r\n          color: \"source\",\r\n          curveness: 0.3,\r\n        },\r\n        emphasis: {\r\n          focus: \"adjacency\",\r\n          lineStyle: {\r\n            width: 10,\r\n          },\r\n        },\r\n        legendHoverLink: true, //是否启用图例 hover(悬停) 时的联动高亮。\r\n        hoverAnimation: true, //是否开启鼠标悬停节点的显示动画\r\n        focusNodeAdjacency: true,\r\n        edgeSymbol: [\"\", \"arrow\"],\r\n        force: {\r\n          edgeLength: 15,\r\n          repulsion: 200,\r\n        },\r\n        draggable: true, //每个节点的拖拉\r\n        itemStyle: {\r\n          emphasis: {\r\n            //鼠标放上去有阴影效果\r\n            shadowColor: \"#00FAE1\",\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 40,\r\n          },\r\n        },\r\n      },\r\n    ],\r\n  };\r\n\r\n  myChart.setOption(option);\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.k-map-chart {\r\n  height: 80vh;\r\n  width: 100%;\r\n}\r\n</style>\r\n"],"mappings":";;gEAEIA,mBAAA,CAA8C;EAAzCC,EAAE,EAAC,WAAW;EAACC,KAAK,EAAC;;;;;;uBAD5BC,YAAA,CAiBeC,uBAAA;IAlBjBC,OAAA,EAAAC,QAAA,CAEI,MAA8C,CAA9CC,UAA8C,EAC9CP,mBAAA,CAOM,cANJQ,YAAA,CAIYC,mBAAA;MARlBC,UAAA,EAKiBC,MAAA,CAAAC,iBAAiB;MALlC,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAKiBH,MAAA,CAAAC,iBAAiB,GAAAE,MAAA;MAC1BC,WAAW,EAAC,iBAAiB;MAC7BC,KAA2B,EAA3B;QAAA;MAAA;6CAEFR,YAAA,CAA8CS,oBAAA;MAAlCC,OAAK,EAAEP,MAAA,CAAAQ;IAAS;MATlCd,OAAA,EAAAC,QAAA,CASoC,MAAI,CATxCc,gBAAA,CASoC,MAAI,E;MATxCC,CAAA;UAWIrB,mBAAA,CAMM,cALJQ,YAAA,CAIcG,MAAA;MAHXW,OAAO,EAAEX,MAAA,CAAAW,OAAO;MACjBC,IAAI,EAAC,UAAU;MACfC,UAAU,EAAV;;IAfRH,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}