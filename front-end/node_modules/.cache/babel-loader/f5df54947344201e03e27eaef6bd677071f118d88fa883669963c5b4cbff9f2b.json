{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as echarts from \"echarts\";\nimport { onMounted, ref } from \"vue\";\nimport { expendNodes } from \"./mock\";\nexport default {\n  __name: 'KMapCharts',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    require(\"echarts/lib/chart/graph\");\n    require(\"echarts/lib/component/tooltip\");\n    require(\"echarts/lib/component/title\");\n\n    //声明周期函数，自动执行初始化\n    onMounted(() => {\n      formatData(expendNodes);\n      initKMapChart();\n    });\n    const seriesData = ref([]);\n    const seriesLinks = ref([]);\n    const categories = ref([]);\n    const lastClickId = ref(\"\");\n    const colors = [\"#a3d2ca\", \"#056676\", \"#ea2c62\", \"#16a596\", \"#03c4a1\", \"#f5a25d\", \"#8CD282\", \"#32e0c4\", \"#00FAE1\", \"#f05454\"];\n    function initKMapChart() {\n      if (!this.KMapChart) {\n        this.KMapChart = echarts.init(document.getElementById(\"KMapChart\"));\n        this.KMapChart.on(\"click\", params => {\n          if (params.dataType === \"node\") {\n            //判断点击的是图表的节点部分\n            this.nodeClick(params);\n          }\n        });\n      }\n      // 指定图表的配置项和数据\n      let option = {\n        // 动画更新变化时间\n        animationDurationUpdate: 500,\n        animationEasingUpdate: \"quinticInOut\",\n        tooltip: {\n          show: false\n        },\n        series: [{\n          type: \"graph\",\n          layout: \"force\",\n          legendHoverLink: true,\n          //是否启用图例 hover(悬停) 时的联动高亮。\n          hoverAnimation: true,\n          //是否开启鼠标悬停节点的显示动画\n          focusNodeAdjacency: true,\n          edgeLabel: {\n            position: \"middle\",\n            //边上的文字样式\n            normal: {\n              show: true,\n              textStyle: {\n                fontSize: 12\n              },\n              position: \"middle\",\n              formatter: function (x) {\n                return x.data.name;\n              }\n            }\n          },\n          edgeSymbol: [\"\", \"arrow\"],\n          force: {\n            edgeLength: 15,\n            repulsion: 200\n          },\n          roam: true,\n          draggable: true,\n          //每个节点的拖拉\n          itemStyle: {\n            normal: {\n              color: \"#00FAE1\",\n              cursor: \"pointer\",\n              //color:Math.floor(Math.random()*16777215).toString(16),\n              //color: ['#fc853e','#28cad8','#9564bf','#bd407e','#28cad8','#fc853e','#e5a214'],\n              label: {\n                show: true,\n                position: [-10, -15],\n                textStyle: {\n                  //标签的字体样式\n                  color: \"#fff\",\n                  //字体颜色\n                  fontStyle: \"normal\",\n                  //文字字体的风格 'normal'标准 'italic'斜体 'oblique' 倾斜\n                  fontWeight: \"bold\",\n                  //'normal'标准'bold'粗的'bolder'更粗的'lighter'更细的或100 | 200 | 300 | 400...\n                  fontFamily: \"sans-serif\",\n                  //文字的字体系列\n                  fontSize: 12 //字体大小\n                }\n              },\n              nodeStyle: {\n                brushType: \"both\",\n                borderColor: \"rgba(255,215,0,0.4)\",\n                borderWidth: 1\n              }\n            },\n            //鼠标放上去有阴影效果\n            emphasis: {\n              shadowColor: \"#00FAE1\",\n              shadowOffsetX: 0,\n              shadowOffsetY: 0,\n              shadowBlur: 40\n            }\n          },\n          lineStyle: {\n            width: 2\n          },\n          label: {\n            fontSize: 18\n          },\n          symbolSize: 24,\n          //节点大小\n          links: this.seriesLinks,\n          data: this.seriesData,\n          categories: this.categories,\n          cursor: \"pointer\"\n        }]\n      };\n      // 使用刚指定的配置项和数据显示图表。\n      this.KMapChart.setOption(option);\n    }\n\n    /**\r\n     * 格式化数据到表格需要的数据\r\n     */\n    function formatData(list, reset = false) {\n      const that = this;\n      let nodes = list.seriesData;\n      this.seriesData = [];\n      this.seriesLinks = [];\n      let colorIndex = 0;\n      let data = [];\n      let loadedCat = [];\n      nodes.forEach((item, index) => {\n        if (item.categary && loadedCat.indexOf(item.categary) === -1) {\n          colorIndex = Math.floor(Math.random() * that.colors.length);\n          loadedCat.push(item.categary);\n          this.categories.push({\n            name: item.categary\n          });\n        }\n        item.itemStyle = {\n          color: that.colors[colorIndex],\n          borderColor: \"#ffffff\"\n        };\n        data.push(item);\n      });\n      this.seriesData.push(...data);\n      this.seriesLinks.push(...list.linksData);\n      this.initCharts();\n    }\n    const __returned__ = {\n      seriesData,\n      seriesLinks,\n      categories,\n      lastClickId,\n      colors,\n      initKMapChart,\n      formatData,\n      get echarts() {\n        return echarts;\n      },\n      onMounted,\n      ref,\n      get expendNodes() {\n        return expendNodes;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["echarts","onMounted","ref","expendNodes","require","formatData","initKMapChart","seriesData","seriesLinks","categories","lastClickId","colors","KMapChart","init","document","getElementById","on","params","dataType","nodeClick","option","animationDurationUpdate","animationEasingUpdate","tooltip","show","series","type","layout","legendHoverLink","hoverAnimation","focusNodeAdjacency","edgeLabel","position","normal","textStyle","fontSize","formatter","x","data","name","edgeSymbol","force","edgeLength","repulsion","roam","draggable","itemStyle","color","cursor","label","fontStyle","fontWeight","fontFamily","nodeStyle","brushType","borderColor","borderWidth","emphasis","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","lineStyle","width","symbolSize","links","setOption","list","reset","that","nodes","colorIndex","loadedCat","forEach","item","index","categary","indexOf","Math","floor","random","length","push","linksData","initCharts"],"sources":["D:/Files/Code/CoursesProjects/YacBugzilla_KnowledgeMap/front-end/src/components/KMapCharts.vue"],"sourcesContent":["<template>\r\n  <div id=\"KMapChart\" class=\"KMapChart\"></div>\r\n</template>\r\n\r\n<script setup>\r\nimport * as echarts from \"echarts\";\r\nimport { onMounted,ref } from \"vue\";\r\nimport { expendNodes } from \"./mock\";\r\nrequire(\"echarts/lib/chart/graph\");\r\nrequire(\"echarts/lib/component/tooltip\");\r\nrequire(\"echarts/lib/component/title\");\r\n\r\n//声明周期函数，自动执行初始化\r\nonMounted(() => {\r\n    formatData(expendNodes);\r\n  initKMapChart();\r\n});\r\n\r\nconst seriesData =ref([]);\r\nconst seriesLinks =ref([]);\r\nconst categories =ref([]);\r\nconst lastClickId  =ref(\"\");\r\nconst colors = [\"#a3d2ca\",\"#056676\",\"#ea2c62\",\"#16a596\",\"#03c4a1\",\"#f5a25d\",\r\n      \"#8CD282\",\"#32e0c4\",\"#00FAE1\",\"#f05454\"]\r\n\r\nfunction initKMapChart() {\r\n  if (!this.KMapChart) {\r\n    this.KMapChart = echarts.init(document.getElementById(\"KMapChart\"));\r\n    this.KMapChart.on(\"click\", (params) => {\r\n      if (params.dataType === \"node\") {\r\n        //判断点击的是图表的节点部分\r\n        this.nodeClick(params);\r\n      }\r\n    });\r\n  }\r\n  // 指定图表的配置项和数据\r\n  let option = {\r\n    // 动画更新变化时间\r\n    animationDurationUpdate: 500,\r\n    animationEasingUpdate: \"quinticInOut\",\r\n    tooltip: {\r\n      show: false,\r\n    },\r\n    series: [\r\n      {\r\n        type: \"graph\",\r\n        layout: \"force\",\r\n        legendHoverLink: true, //是否启用图例 hover(悬停) 时的联动高亮。\r\n        hoverAnimation: true, //是否开启鼠标悬停节点的显示动画\r\n        focusNodeAdjacency: true,\r\n        edgeLabel: {\r\n          position: \"middle\", //边上的文字样式\r\n          normal: {\r\n            show: true,\r\n            textStyle: {\r\n              fontSize: 12,\r\n            },\r\n            position: \"middle\",\r\n            formatter: function (x) {\r\n              return x.data.name;\r\n            },\r\n          },\r\n        },\r\n        edgeSymbol: [\"\", \"arrow\"],\r\n        force: {\r\n          edgeLength: 15,\r\n          repulsion: 200,\r\n        },\r\n        roam: true,\r\n        draggable: true, //每个节点的拖拉\r\n        itemStyle: {\r\n          normal: {\r\n            color: \"#00FAE1\",\r\n            cursor: \"pointer\",\r\n            //color:Math.floor(Math.random()*16777215).toString(16),\r\n            //color: ['#fc853e','#28cad8','#9564bf','#bd407e','#28cad8','#fc853e','#e5a214'],\r\n            label: {\r\n              show: true,\r\n              position: [-10, -15],\r\n              textStyle: {\r\n                //标签的字体样式\r\n                color: \"#fff\", //字体颜色\r\n                fontStyle: \"normal\", //文字字体的风格 'normal'标准 'italic'斜体 'oblique' 倾斜\r\n                fontWeight: \"bold\", //'normal'标准'bold'粗的'bolder'更粗的'lighter'更细的或100 | 200 | 300 | 400...\r\n                fontFamily: \"sans-serif\", //文字的字体系列\r\n                fontSize: 12, //字体大小\r\n              },\r\n            },\r\n            nodeStyle: {\r\n              brushType: \"both\",\r\n              borderColor: \"rgba(255,215,0,0.4)\",\r\n              borderWidth: 1,\r\n            },\r\n          },\r\n          //鼠标放上去有阴影效果\r\n          emphasis: {\r\n            shadowColor: \"#00FAE1\",\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 40,\r\n          },\r\n        },\r\n        lineStyle: {\r\n          width: 2,\r\n        },\r\n        label: {\r\n          fontSize: 18,\r\n        },\r\n        symbolSize: 24, //节点大小\r\n        links: this.seriesLinks,\r\n        data: this.seriesData,\r\n        categories: this.categories,\r\n        cursor: \"pointer\",\r\n      },\r\n    ],\r\n  };\r\n  // 使用刚指定的配置项和数据显示图表。\r\n  this.KMapChart.setOption(option);\r\n}\r\n\r\n/**\r\n * 格式化数据到表格需要的数据\r\n */\r\nfunction formatData(list, reset = false) {\r\n  const that = this;\r\n  let nodes = list.seriesData;\r\n  this.seriesData = [];\r\n  this.seriesLinks = [];\r\n  let colorIndex = 0;\r\n  let data = [];\r\n  let loadedCat = [];\r\n  nodes.forEach((item, index) => {\r\n    if (item.categary && loadedCat.indexOf(item.categary) === -1) {\r\n      colorIndex = Math.floor(Math.random() * that.colors.length);\r\n      loadedCat.push(item.categary);\r\n      this.categories.push({ name: item.categary });\r\n    }\r\n    item.itemStyle = {\r\n      color: that.colors[colorIndex],\r\n      borderColor: \"#ffffff\",\r\n    };\r\n    data.push(item);\r\n  });\r\n  this.seriesData.push(...data);\r\n  this.seriesLinks.push(...list.linksData);\r\n  this.initCharts();\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}