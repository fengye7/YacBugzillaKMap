{"ast":null,"code":"import { onMounted, ref } from \"vue\";\nimport { getKMapData } from '@/api/KMapAPI.js';\nimport * as echarts from 'echarts';\nexport default {\n  __name: 'KMapCharts',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const seriesData = ref([]);\n    const seriesLinks = ref([]);\n    const categories = ref([{\n      name: 'product'\n    }, {\n      name: 'component'\n    }, {\n      name: 'assignee'\n    }]);\n    const competitorDomains = ref('');\n    onMounted(() => {\n      initKMapChart();\n    });\n    async function fetchData() {\n      try {\n        const domains = competitorDomains.value.split(',').map(domain => domain.trim());\n        const response = await getKMapData(domains);\n        const kMapData = response.data;\n        formatData(kMapData);\n        initKMapChart();\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    }\n    function formatData(data) {\n      seriesData.value = data.nodes;\n      seriesLinks.value = data.links;\n    }\n    function initKMapChart() {\n      const chartDom = document.getElementById('KMapChart');\n      const myChart = echarts.init(chartDom);\n      const option = {\n        animationDurationUpdate: 500,\n        animationEasingUpdate: 'quinticInOut',\n        tooltip: {\n          show: true\n        },\n        series: [{\n          type: 'graph',\n          layout: 'force',\n          data: seriesData.value,\n          links: seriesLinks.value,\n          categories: categories.value,\n          roam: true,\n          label: {\n            position: 'right',\n            formatter: '{b}'\n          },\n          lineStyle: {\n            color: 'source',\n            curveness: 0.3\n          },\n          emphasis: {\n            focus: 'adjacency',\n            lineStyle: {\n              width: 10\n            }\n          },\n          legendHoverLink: true,\n          //是否启用图例 hover(悬停) 时的联动高亮。\n          hoverAnimation: true,\n          //是否开启鼠标悬停节点的显示动画\n          focusNodeAdjacency: true,\n          edgeLabel: {\n            position: \"middle\",\n            //边上的文字样式\n            normal: {\n              show: true,\n              textStyle: {\n                fontSize: 12\n              },\n              position: \"middle\",\n              formatter: function (x) {\n                return x.data.name;\n              }\n            }\n          },\n          edgeSymbol: [\"\", \"arrow\"],\n          force: {\n            edgeLength: 15,\n            repulsion: 200\n          },\n          draggable: true,\n          //每个节点的拖拉\n          itemStyle: {\n            normal: {\n              color: \"#00FAE1\",\n              cursor: \"pointer\",\n              label: {\n                show: true,\n                position: [-10, -15],\n                textStyle: {\n                  //标签的字体样式\n                  color: \"#AB8\",\n                  //字体颜色\n                  fontStyle: \"normal\",\n                  //文字字体的风格 'normal'标准 'italic'斜体 'oblique' 倾斜\n                  fontWeight: \"bold\",\n                  //'normal'标准'bold'粗的'bolder'更粗的'lighter'更细的或100 | 200 | 300 | 400...\n                  fontFamily: \"sans-serif\",\n                  //文字的字体系列\n                  fontSize: 12 //字体大小\n                }\n              },\n              nodeStyle: {\n                brushType: \"both\",\n                borderColor: \"rgba(255,215,0,0.4)\",\n                borderWidth: 1\n              }\n            },\n            emphasis: {\n              //鼠标放上去有阴影效果\n              shadowColor: \"#00FAE1\",\n              shadowOffsetX: 0,\n              shadowOffsetY: 0,\n              shadowBlur: 40\n            }\n          }\n        }]\n      };\n      myChart.setOption(option);\n    }\n    const __returned__ = {\n      seriesData,\n      seriesLinks,\n      categories,\n      competitorDomains,\n      fetchData,\n      formatData,\n      initKMapChart,\n      onMounted,\n      ref,\n      get getKMapData() {\n        return getKMapData;\n      },\n      get echarts() {\n        return echarts;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","getKMapData","echarts","seriesData","seriesLinks","categories","name","competitorDomains","initKMapChart","fetchData","domains","value","split","map","domain","trim","response","kMapData","data","formatData","error","console","nodes","links","chartDom","document","getElementById","myChart","init","option","animationDurationUpdate","animationEasingUpdate","tooltip","show","series","type","layout","roam","label","position","formatter","lineStyle","color","curveness","emphasis","focus","width","legendHoverLink","hoverAnimation","focusNodeAdjacency","edgeLabel","normal","textStyle","fontSize","x","edgeSymbol","force","edgeLength","repulsion","draggable","itemStyle","cursor","fontStyle","fontWeight","fontFamily","nodeStyle","brushType","borderColor","borderWidth","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","setOption"],"sources":["D:/Files/Code/CoursesProjects/YacBugzilla_KnowledgeMap/front-end/src/components/KMapCharts.vue"],"sourcesContent":["<template>\r\n  <el-container>\r\n    <div id=\"KMapChart\" class=\"k-map-chart\"></div>\r\n    <div>\r\n      <el-input v-model=\"competitorDomains\" placeholder=\"输入竞争公司域名, 以逗号分隔\" style=\"margin-bottom: 20px;\"></el-input>\r\n      <el-button @click=\"fetchData\">获取数据</el-button>\r\n    </div>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref } from \"vue\";\r\nimport { getKMapData } from '@/api/KMapAPI.js';\r\nimport * as echarts from 'echarts';\r\n\r\nconst seriesData = ref([]);\r\nconst seriesLinks = ref([]);\r\nconst categories = ref([\r\n  { name: 'product' },\r\n  { name: 'component' },\r\n  { name: 'assignee' }\r\n]);\r\n\r\nconst competitorDomains = ref('');\r\n\r\nonMounted(() => {\r\n  initKMapChart();\r\n});\r\n\r\nasync function fetchData() {\r\n  try {\r\n    const domains = competitorDomains.value.split(',').map(domain => domain.trim());\r\n    const response = await getKMapData(domains);\r\n    const kMapData = response.data;\r\n    formatData(kMapData);\r\n    initKMapChart();\r\n  } catch (error) {\r\n    console.error('Error fetching data:', error);\r\n  }\r\n}\r\n\r\nfunction formatData(data) {\r\n  seriesData.value = data.nodes;\r\n  seriesLinks.value = data.links;\r\n}\r\n\r\nfunction initKMapChart() {\r\n  const chartDom = document.getElementById('KMapChart');\r\n  const myChart = echarts.init(chartDom);\r\n  const option = {\r\n    animationDurationUpdate: 500,\r\n    animationEasingUpdate: 'quinticInOut',\r\n    tooltip: {\r\n      show: true,\r\n    },\r\n    series: [\r\n      {\r\n        type: 'graph',\r\n        layout: 'force',\r\n        data: seriesData.value,\r\n        links: seriesLinks.value,\r\n        categories: categories.value,\r\n        roam: true,\r\n        label: {\r\n          position: 'right',\r\n          formatter: '{b}'\r\n        },\r\n        lineStyle: {\r\n          color: 'source',\r\n          curveness: 0.3\r\n        },\r\n        emphasis: {\r\n          focus: 'adjacency',\r\n          lineStyle: {\r\n            width: 10\r\n          }\r\n        },\r\n        legendHoverLink: true, //是否启用图例 hover(悬停) 时的联动高亮。\r\n        hoverAnimation: true, //是否开启鼠标悬停节点的显示动画\r\n        focusNodeAdjacency: true,\r\n        edgeLabel: {\r\n          position: \"middle\", //边上的文字样式\r\n          normal: {\r\n            show: true,\r\n            textStyle: {\r\n              fontSize: 12,\r\n            },\r\n            position: \"middle\",\r\n            formatter: function (x) {\r\n              return x.data.name;\r\n            },\r\n          },\r\n        },\r\n        edgeSymbol: [\"\", \"arrow\"],\r\n        force: {\r\n          edgeLength: 15,\r\n          repulsion: 200,\r\n        },\r\n        draggable: true, //每个节点的拖拉\r\n        itemStyle: {\r\n          normal: {\r\n            color: \"#00FAE1\",\r\n            cursor: \"pointer\",\r\n            label: {\r\n              show: true,\r\n              position: [-10, -15],\r\n              textStyle: {\r\n                //标签的字体样式\r\n                color: \"#AB8\", //字体颜色\r\n                fontStyle: \"normal\", //文字字体的风格 'normal'标准 'italic'斜体 'oblique' 倾斜\r\n                fontWeight: \"bold\", //'normal'标准'bold'粗的'bolder'更粗的'lighter'更细的或100 | 200 | 300 | 400...\r\n                fontFamily: \"sans-serif\", //文字的字体系列\r\n                fontSize: 12, //字体大小\r\n              },\r\n            },\r\n            nodeStyle: {\r\n              brushType: \"both\",\r\n              borderColor: \"rgba(255,215,0,0.4)\",\r\n              borderWidth: 1,\r\n            },\r\n          },\r\n          emphasis: {\r\n            //鼠标放上去有阴影效果\r\n            shadowColor: \"#00FAE1\",\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 40,\r\n          },\r\n        },\r\n      }\r\n    ]\r\n  };\r\n\r\n  myChart.setOption(option);\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.k-map-chart {\r\n  height: 80vh;\r\n  width: 100%;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}