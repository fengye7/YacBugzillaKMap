{"ast":null,"code":"import { onMounted, ref } from \"vue\";\nimport { getKMapData } from \"@/api/KMapAPI.js\";\nimport * as echarts from \"echarts\";\nexport default {\n  __name: 'KMapCharts',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const seriesData = ref([]);\n    const seriesLinks = ref([]);\n    const categories = ref([{\n      name: \"product\"\n    }, {\n      name: \"component\"\n    }, {\n      name: \"assignee\"\n    }]);\n    const competitorDomains = ref(\"\");\n    const loading = ref(false);\n    onMounted(() => {\n      initKMapChart();\n    });\n    async function fetchData() {\n      loading.value = true;\n      try {\n        const domains = competitorDomains.value.split(\",\").map(domain => domain.trim());\n        const response = await getKMapData(domains);\n        const kMapData = response.data;\n        formatData(kMapData);\n        initKMapChart();\n      } catch (error) {\n        console.error(\"Error fetching data:\", error);\n      } finally {\n        loading.value = false;\n      }\n    }\n    function formatData(data) {\n      seriesData.value = data.nodes;\n      seriesLinks.value = data.links;\n    }\n    function initKMapChart() {\n      const chartDom = document.getElementById(\"KMapChart\");\n      const myChart = echarts.init(chartDom);\n      const option = {\n        animationDurationUpdate: 500,\n        animationEasingUpdate: \"quinticInOut\",\n        tooltip: {\n          show: true\n        },\n        series: [{\n          type: \"graph\",\n          layout: \"force\",\n          data: seriesData.value,\n          links: seriesLinks.value,\n          categories: categories.value,\n          roam: true,\n          label: {\n            position: \"right\",\n            formatter: \"{b}\"\n          },\n          lineStyle: {\n            color: \"source\",\n            curveness: 0.3\n          },\n          emphasis: {\n            focus: \"adjacency\",\n            lineStyle: {\n              width: 10\n            }\n          },\n          legendHoverLink: true,\n          //是否启用图例 hover(悬停) 时的联动高亮。\n          hoverAnimation: true,\n          //是否开启鼠标悬停节点的显示动画\n          focusNodeAdjacency: true,\n          edgeSymbol: [\"\", \"arrow\"],\n          force: {\n            edgeLength: 15,\n            repulsion: 200\n          },\n          draggable: true,\n          //每个节点的拖拉\n          itemStyle: {\n            emphasis: {\n              //鼠标放上去有阴影效果\n              shadowColor: \"#00FAE1\",\n              shadowOffsetX: 0,\n              shadowOffsetY: 0,\n              shadowBlur: 40\n            }\n          }\n        }]\n      };\n      myChart.setOption(option);\n    }\n    const __returned__ = {\n      seriesData,\n      seriesLinks,\n      categories,\n      competitorDomains,\n      loading,\n      fetchData,\n      formatData,\n      initKMapChart,\n      onMounted,\n      ref,\n      get getKMapData() {\n        return getKMapData;\n      },\n      get echarts() {\n        return echarts;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","getKMapData","echarts","seriesData","seriesLinks","categories","name","competitorDomains","loading","initKMapChart","fetchData","value","domains","split","map","domain","trim","response","kMapData","data","formatData","error","console","nodes","links","chartDom","document","getElementById","myChart","init","option","animationDurationUpdate","animationEasingUpdate","tooltip","show","series","type","layout","roam","label","position","formatter","lineStyle","color","curveness","emphasis","focus","width","legendHoverLink","hoverAnimation","focusNodeAdjacency","edgeSymbol","force","edgeLength","repulsion","draggable","itemStyle","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","setOption"],"sources":["D:/Files/Code/CoursesProjects/YacBugzilla_KnowledgeMap/front-end/src/components/KMapCharts.vue"],"sourcesContent":["<template>\r\n  <el-container\r\n    v-loading=\"loading\"\r\n    element-loading-text=\"Loading...\"\r\n    fullscreen\r\n  >\r\n    <div id=\"KMapChart\" class=\"k-map-chart\"></div>\r\n    <div>\r\n      <el-input\r\n        v-model=\"competitorDomains\"\r\n        placeholder=\"输入竞争公司域名, 以逗号分隔\"\r\n        style=\"margin-bottom: 20px\"\r\n      ></el-input>\r\n      <el-button @click=\"fetchData\">获取数据</el-button>\r\n    </div>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref } from \"vue\";\r\nimport { getKMapData } from \"@/api/KMapAPI.js\";\r\nimport * as echarts from \"echarts\";\r\n\r\nconst seriesData = ref([]);\r\nconst seriesLinks = ref([]);\r\nconst categories = ref([\r\n  { name: \"product\" },\r\n  { name: \"component\" },\r\n  { name: \"assignee\" },\r\n]);\r\n\r\nconst competitorDomains = ref(\"\");\r\nconst loading = ref(false);\r\n\r\nonMounted(() => {\r\n  initKMapChart();\r\n});\r\n\r\nasync function fetchData() {\r\n  loading.value = true;\r\n  try {\r\n    const domains = competitorDomains.value\r\n      .split(\",\")\r\n      .map((domain) => domain.trim());\r\n    const response = await getKMapData(domains);\r\n    const kMapData = response.data;\r\n    formatData(kMapData);\r\n    initKMapChart();\r\n  } catch (error) {\r\n    console.error(\"Error fetching data:\", error);\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nfunction formatData(data) {\r\n  seriesData.value = data.nodes;\r\n  seriesLinks.value = data.links;\r\n}\r\n\r\nfunction initKMapChart() {\r\n  const chartDom = document.getElementById(\"KMapChart\");\r\n  const myChart = echarts.init(chartDom);\r\n  const option = {\r\n    animationDurationUpdate: 500,\r\n    animationEasingUpdate: \"quinticInOut\",\r\n    tooltip: {\r\n      show: true,\r\n    },\r\n    series: [\r\n      {\r\n        type: \"graph\",\r\n        layout: \"force\",\r\n        data: seriesData.value,\r\n        links: seriesLinks.value,\r\n        categories: categories.value,\r\n        roam: true,\r\n        label: {\r\n          position: \"right\",\r\n          formatter: \"{b}\",\r\n        },\r\n        lineStyle: {\r\n          color: \"source\",\r\n          curveness: 0.3,\r\n        },\r\n        emphasis: {\r\n          focus: \"adjacency\",\r\n          lineStyle: {\r\n            width: 10,\r\n          },\r\n        },\r\n        legendHoverLink: true, //是否启用图例 hover(悬停) 时的联动高亮。\r\n        hoverAnimation: true, //是否开启鼠标悬停节点的显示动画\r\n        focusNodeAdjacency: true,\r\n        edgeSymbol: [\"\", \"arrow\"],\r\n        force: {\r\n          edgeLength: 15,\r\n          repulsion: 200,\r\n        },\r\n        draggable: true, //每个节点的拖拉\r\n        itemStyle: {\r\n          emphasis: {\r\n            //鼠标放上去有阴影效果\r\n            shadowColor: \"#00FAE1\",\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 40,\r\n          },\r\n        },\r\n      },\r\n    ],\r\n  };\r\n\r\n  myChart.setOption(option);\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.k-map-chart {\r\n  height: 80vh;\r\n  width: 100%;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}